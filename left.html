<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Columna Izquierda</title>

     <style>
     	html {
           background: linear-gradient(45deg, white, white);
             }
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }

        .boton-conectar {
            background-color: silver;
            color: black;
            border: 2px solid silver;
            border-radius: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .boton-conectar:hover {
            background-color: yellow;
            border-color: yellow;
        }

       

    </style>

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
      <link href="bootstrap/css/jquery.dataTables.css" rel="stylesheet">
      <link href="css/style.css" rel="stylesheet">


</head>
<body>

    <aside>
 <div class="container">        
 <div class="row">

                          
          



  <div class="col-md-1">      
 <h3 style="margin-left: 10px; display: inline-block;">
    <img src="images/caw_logo_3.svg" alt="My svg_logo" width="50" style="transform: rotate(45deg);">
    <span style="vertical-align: middle;">XCaw</span>
  </h3>
</p>
<br>
</div>

 <div class="col-md-1"> 
<p>
  <h3 style="margin-left: 10px; display: inline-block;">
    <span class="glyphicon glyphicon-home" style="font-size: 24px; vertical-align: middle;"></span>
    <span style="vertical-align: middle;">Home</span>
  </h3>
</p>
</div>


 <div class="col-md-1"> 
<p>
  <h3 style="margin-left: 10px; display: inline-block;">
    <span class="glyphicon glyphicon-search" style="font-size: 24px; vertical-align: middle;"></span>
    <span style="vertical-align: middle;">Find</span>
  </h3>
</p>
</div>

<div class="col-md-1"> 
<p>
  <h3 style="margin-left: 10px; display: inline-block;">
    <span class="glyphicon glyphicon-user" style="font-size: 24px; vertical-align: middle;"></span>
    <span style="vertical-align: middle;">Profile</span>
  </h3>
</p>
</div>

<div class="col-md-1"> 
<p>
  <h3 style="margin-left: 10px; display: inline-block;">
    <span class="glyphicon glyphicon-cog" style="font-size: 24px; vertical-align: middle;"></span>
    <span style="vertical-align: middle;">Config</span>
  </h3>
</p>
</div>



<div class="col-md-1"> 
	<button id="btn-obtener-saldo">Obtener Saldo</button>
	<div id="saldo">CAW token:</div>
 
</div>


<div class="col-md-6"> 
	<div class="container">    
      <button class="boton-conectar" id="botonConectar">Conectar</button>  
	</div> 

	
   

	

	  
</div>


</div>
</div>
<!--
	glyphicon glyphicon-cog
		

			glyphicon glyphicon-picture

				glyphicon glyphicon-plus-sign
					glyphicon glyphicon-heart-empty
						glyphicon glyphicon-send
							glyphicon glyphicon-heart
								glyphicon glyphicon-th-list
									
										glyphicon glyphicon-refresh

											glyphicon glyphicon-qrcode
											glyphicon glyphicon-map-marker
												glyphicon glyphicon-retweet

-->
    


        <!-- Puedes agregar más elementos según sea necesario -->
    </aside>

<script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
<script>

	     const CAW_tokenABI = [{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"authorizeContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"revokeAuthorization","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"user","type":"address"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}];

        // Constantes y variables globales
        const tokenContractAddress = '0x4F024804734fcaECb4f454676998211675F84C89';
         
        const web3 = new Web3(window.ethereum);//conexion global de web3 

        const tokenContract = new web3.eth.Contract(CAW_tokenABI, tokenContractAddress);



        // Función para conectar con MetaMask en el archivo izquierdo
        async function conectarMetaMask() {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    console.log('Conexión exitosa con MetaMask desde el archivo izquierdo');

                    const accounts = await web3.eth.getAccounts();
                    const myAddress = accounts[0];

                    showSuccess('Conectado con éxito a MetaMask. Dirección de la cuenta: ' + myAddress);


                    // Otros botones y acciones
                    const btnObtenerSaldo = document.getElementById('btn-obtener-saldo');
                    btnObtenerSaldo.addEventListener('click', obtenerSaldo);








                } catch (error) {
                    console.error('Error al conectar con MetaMask:', error.message);
                }
            } else {
                console.error('MetaMask no está instalado.');
            }
        }


         // Función para obtener el saldo del token
          async function obtenerSaldo() {
            // Obtener la dirección de la cuenta conectada
            const accounts = await web3.eth.getAccounts();
            const myAddress = accounts[0];
            alert('Conectado con éxito a MetaMask. Dirección de la cuenta: ' + myAddress);

            //const tokenContractAddress = '0x4F024804734fcaECb4f454676998211675F84C89';
            // Crear una instancia del contrato del token
            const tokenContract = new web3.eth.Contract(CAW_tokenABI,tokenContractAddress);
            // Obtener el saldo del token para la dirección de la cuenta conectada
            const accountBalance = await tokenContract.methods.balanceOf(myAddress).call();
            // Mostrar el saldo en la página web
            const saldoElement = document.getElementById('saldo');
            saldoElement.innerText = 'Saldo: ' + accountBalance;
            
          }

        // Agregar un evento de clic al botón para llamar a la función conectarMetaMask
        document.getElementById("botonConectar").addEventListener("click", conectarMetaMask);



         // Funciones para mostrar mensajes en la página
          function showSuccess(message) {
            const successElement = document.getElementById('success-message');
            successElement.innerText = message;
          }

          function showError(message) {
            const errorElement = document.getElementById('error-message');
            errorElement.innerText = message;
          }

          function showBalance(balance) {
            const balanceElement = document.getElementById('saldo');
            balanceElement.innerText = 'Saldo: ' + balance;
          }
   


    </script>
   


</body>
</html>