<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XCaw.app</title>
  <style>

    html {
      background: linear-gradient(45deg, white, black);
    }
  
 
  </style>

                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
                <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
                <link href="bootstrap/css/jquery.dataTables.css" rel="stylesheet">
                <link href="css/style.css" rel="stylesheet">
             
</head>


<body>    

<br> 
 

        <div class="row">

            <div class="col-md-1">                
            </div>
            <div class="col-md-2">
                <iframe src="left.html" width="100%" height="100%"></iframe>
            </div>
            <div class="col-md-6">
                <iframe src="center.html" width="100%" height="100%"></iframe>
            </div>
            <div class="col-md-2">
                <iframe src="right.html" width="100%" height="100%"></iframe>
            </div>
             <div class="col-md-1">                
            </div>
        </div>

    

 
<script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>

    <script>



        const CAW_tokenABI = [{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"authorizeContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"revokeAuthorization","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"user","type":"address"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}];

        // Constantes y variables globales
        const tokenContractAddress = '0x4F024804734fcaECb4f454676998211675F84C89';
         
        const web3 = new Web3(window.ethereum);//conexion global de web3 


        // Función para conectar con MetaMask en el documento principal
        async function conectarMetaMask() {
            if (typeof window.ethereum === 'undefined') {
              showError('MetaMask is not installed.');
              return;
            }

            try {
              await window.ethereum.enable();
              // Crear una instancia de web3 con MetaMask como proveedor
       ///*       const web3 = new Web3(window.ethereum);
              const accounts = await web3.eth.getAccounts();
              const myAddress = accounts[0];

              showSuccess('Account: ' + myAddress);

              // Obtener el saldo automáticamente al conectarse
              obtenerSaldo();
              
              // Otros botones y acciones
              const btnObtenerSaldo = document.getElementById('btn-obtener-saldo');
              btnObtenerSaldo.addEventListener('click', obtenerSaldo);

              ////////////////////////////////////////////////////////////////////////////


              // ...
            } catch (error) {
              showError('Hubo un error al conectar con MetaMask: ' + error.message);
            }
          } 


          // Función para obtener el saldo del token
          async function obtenerSaldo() {
            // Obtener la dirección de la cuenta conectada
            const accounts = await web3.eth.getAccounts();
            const myAddress = accounts[0];
 //           alert('Conectado con éxito a MetaMask. Dirección de la cuenta: ' + myAddress);

            const tokenContract = new web3.eth.Contract(CAW_tokenABI,tokenContractAddress);
            // Obtener el saldo del token para la dirección de la cuenta conectada
            const accountBalance = await tokenContract.methods.balanceOf(myAddress).call();
            // Mostrar el saldo en la página web
            const saldoElement = document.getElementById('saldo');
            saldoElement.innerText = 'Caw Token: ' + accountBalance;
            
          }




    </script>


</body>
</html>